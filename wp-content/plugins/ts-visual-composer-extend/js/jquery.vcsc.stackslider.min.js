!function(t,i,s){"use strict";var e=t(i);t(document);t.StackSlider=function(i,s){this.$stack=t(s).hide(),this._init(i),this.$maxPileHeight=0},t.StackSlider.defaults={group:"stackgallery",lightbox:!0,speed:600,easing:"ease-in-out",piles:!0,autoheight:!0},t.StackSlider.prototype={_init:function(i){this.options=t.extend(!0,{},t.StackSlider.defaults,i),this.support=TS_VCSC_Supports3D;this.support&&(this.transEndEventName={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[TS_VCSC_StyleSupport("transition")]+".stackslider",this.transformName={WebkitTransform:"-webkit-transform",MozTransform:"-moz-transform",OTransform:"-o-transform",msTransform:"-ms-transform",transform:"transform"}[TS_VCSC_StyleSupport("transform")]),this.current=0;if(this._layout(),0===this.itemsCount)return!1;this._initEvents(),this.options.lightbox&&jQuery("."+this.options.group).krautlightbox()},_layout:function(){var i=this.$stack.children("li");this.itemsCount=i.length,this.$wrapper=t('<div class="st-wrapper"></div>'),this.options.piles&&(this.$lPile=t('<div class="st-stack st-stack-left"></div>'),this.$rPile=t('<div class="st-stack st-stack-right"></div>'),this.$wrapper.append(this.$lPile,this.$rPile)),this.$title=t('<div class="st-title"></div>').appendTo(this.$wrapper),this.itemsCount>1&&(this.$navigation=t('<div class="nav"><span class="st-first">First</span><span class="st-prev">Previous</span><span class="st-next">Next</span><span class="st-last">Last</span></div>'),this.$wrapper.append(this.$navigation));var s="";i.each(function(){var i=t(this);s+='<div class="st-item" data-title="'+i.children("div.st-title").html()+'">'+i.children("div.st-item").html()+"</div>"}),this.$listitems=t('<div class="st-item-list"></div>').html(s),this.$items=this.$listitems.children("div").hide(),this.$wrapper.insertAfter(this.$stack).prepend(this.$listitems),this.$stack.remove(),this.options.piles&&this.$rPile.css("height","+="+5*(this.itemsCount-1)),this._setSize(),this._initItems()},_setSize:function(){var t=1.25*this.$items.height();this.radius=this.$wrapper.width()/2-t/2,this.options.piles&&(this.$lPile.css("width","25%"),this.$rPile.css("width","25%"))},_initEvents:function(t){var i=this;this.$navigation.children("span.st-next").on({"mousedown.stackslider":function(){i._navigate("next"),i.startflowtimeout=setTimeout(function(){i.flow=!0,i._flow("next")},600)},"mouseup.stackslider mouseleave.stackslider":function(){i._mouseup("next")}}).end().children("span.st-prev").on({"mousedown.stackslider":function(){i._navigate("prev"),i.startflowtimeout=setTimeout(function(){i.flow=!0,i._flow("prev")},600)},"mouseup.stackslider mouseleave.stackslider":function(){i._mouseup("prev")}}).end().children("span.st-first").on({"mousedown.stackslider":function(){i._navigate("first"),i.startflowtimeout=setTimeout(function(){i.flow=!0,i._flow("first")},600),i._mouseup("first")}}).end().children("span.st-last").on({"mousedown.stackslider":function(){i._navigate("last"),i.startflowtimeout=setTimeout(function(){i.flow=!0,i._flow("last")},600),i._mouseup("last")}}),e.on("debouncedresize.stackslider",function(){i._setSize(),i._initItems()})},_mouseup:function(t){var i=this;clearTimeout(this.startflowtimeout),clearTimeout(this.flowtimeout),this.flow&&(setTimeout(function(){0!==i.current&&i.current!==i.itemsCount-1&&i._navigate(t)},100),this.flow=!1)},_flow:function(t){var i=this;this._navigate(t,!0),this.flowtimeout=setTimeout(function(){i._flow(t)},150)},_navigate:function(i,s){var e,n,r,o,a,h=this,l="st-left st-center st-right st-leftflow st-rightflow",c=this.$items.eq(this.current),u=this.$wrapper,d=this.$lPile,p=this.$rPile,f=this.options.piles?d.height()+p.height():80,m=this.options.autoheight,g=this.itemsCount;if("next"===i&&this.current<this.itemsCount-1)++this.current,n="st-left",e=s?"st-leftflow":n,r="right",o="left",a="normal";else if("prev"===i&&this.current>0)--this.current,n="st-right",e=s?"st-rightflow":n,r="left",o="right",a="normal";else if("first"===i&&this.current>0)this.current=0,n="st-right",e=s?"st-rightflow":n,r="left",o="right",a="circle";else{if(!("last"===i&&this.current<this.itemsCount-1))return!1;this.current=this.itemsCount-1,n="st-left",e=s?"st-leftflow":n,r="right",o="left",a="circle"}this._updatePile(r,"out",a,g);var v=this.$items.eq(this.current);c.removeClass(l).addClass(e),this.support?c.on(this.transEndEventName,function(){t(this).removeClass(l).addClass(n).off(h.transEndEventName),h._updatePile(o,"in",a,g)}):(c.removeClass(l).addClass(n),this._updatePile(o,"in",a,g)),v.show(),setTimeout(function(){(!s||0!==h.current&&h.current!==h.itemsCount-1)&&s||(v.removeClass(l).addClass("st-center"),m&&u.height(v.find("img").height()+f+25))},25),clearTimeout(this.titletimeout);var w=this.support?this.options.speed:0;this.titletimeout=setTimeout(function(){h.$title.html(v.data("title"))},w)},_updatePile:function(t,i,s,e){if(!this.options.piles)return!1;"right"===t&&"normal"===s?this.$rPile.css("height","in"===i?"+=5":"-=5"):"left"===t&&"normal"===s?this.$lPile.css("height","in"===i?"+=5":"-=5"):"left"===t&&"circle"===s?this.$lPile.css("height","in"===i?5*e-5:"5"):"right"===t&&"circle"===s&&this.$rPile.css("height","in"===i?5*e-5:"5")},_initItems:function(){var i=this,s=this.$wrapper.width(),e=(this.$wrapper.height(),this.$items.eq(this.current).addClass("st-center").show()),n=this.options.piles?Math.max(this.$lPile.height(),this.$rPile.height())/2:40,r=this.options.piles?this.$lPile.height()+this.$rPile.height():80,o=0;this.$title.html(e.data("title")),this.$items.each(function(e){var r=t(this),a=r.find("img").height(),h=r.width();i.radius;r.index()!==i.current&&r.addClass("st-right"),r.find("img").attr("data-stack",s/r.find("img").attr("data-ratio")),s/r.find("img").attr("data-ratio")>o&&(o=s/r.find("img").attr("data-ratio")),i.support&&r.css({transition:i.transformName+" "+i.options.speed+"ms "+i.options.easing+", opacity "+i.options.speed+"ms "+i.options.easing,transformOrigin:"50% "+(i.radius+a/2-n)+"px"}),r.css({left:s/2-h/2,top:0})}),this.options.autoheight?this.$wrapper.height(e.find("img").height()+r+25):this.$wrapper.height(o+r+25)}};var n=function(t){i.console&&i.console.error(t)};t.fn.stackslider=function(i){var s=t.data(this,"stackslider");if("string"==typeof i){var e=Array.prototype.slice.call(arguments,1);this.each(function(){s?t.isFunction(s[i])&&"_"!==i.charAt(0)?s[i].apply(s,e):n("no such method '"+i+"' for stackslider instance"):n("cannot call methods on stackslider prior to initialization; attempted to call method '"+i+"'")})}else this.each(function(){s?s._init():s=t.data(this,"stackslider",new t.StackSlider(i,this))});return s}}(jQuery,window);