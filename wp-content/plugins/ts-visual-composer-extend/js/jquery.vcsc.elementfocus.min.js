!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){var t=null,o=null,a=null,r=null,n=!1;e.fn.TS_VCSC_Element_Focus=function(p){var u=e.extend({},{random:1,pageLoad:!1,pagescroll:!1,viewportShow:!1,viewportOnce:!0,viewportOffset:"50%",repeat:!1,timer:0,wait:5e3,delay:0,opacity:.5,speed:"medium",focusColor:"#066BC0",frameColor:"#cccccc",frameStrength:10,showEvent:"mouseenter",parentSelector:"html",onShow:function(){},onHide:function(){},paddingX:20,paddingY:20,rasterUse:!1,rasterType:"",popupShow:!1,popupType:"",popupPosition:"centercenter",popupButton:!0,popupConfirm:"OK",popupTitle:"",popupText:"",popupHTML:"",popupClose:!1,popupLayer:"",popupImage:"",popupIcon:"",popupColor:"#000000",popupTimer:0,color:"#333",animate:!0,easing:"",exitEvent:"click",spotlightZIndex:9999,spotlightElementClass:"spotlight-background"},p);return this.each(function(){function p(){try{o.remove()}catch(a){}o=null,y=null,w=null,y=e('<canvas id="ts-element-focus-overlay-'+u.random+'"></canvas>'),y.addClass(u.spotlightElementClass),o=y,t=u.random,v=e(u.parentSelector),y.addClass("ts-element-focus-overlay").addClass("ts-element-focus-overlay-"+u.speed),v.append(y);var n={position:"fixed",top:0,left:0,height:"100%",width:"100%"};"html"==u.parentSelector&&v.css("height","100%"),y.css(n),w=y[0].getContext("2d"),C=e('<canvas id="ts-element-focus-frame-'+u.random+'"></canvas>'),r=C,C.addClass("ts-element-focus-frame"),v.append(C);var p={background:"transparent",position:"fixed",top:0,left:0,height:"100%",width:"100%"};C.css(p),g=C[0].getContext("2d")}function s(){if(!n&&"true"!=b.attr("data-focus-active")){if(jQuery(".ts-element-focus-overlay").length>0){try{e("#ts-element-focus-overlay-"+u.random).remove()}catch(t){}try{e("#ts-element-focus-noise-"+u.random).remove()}catch(t){}try{e("#ts-element-focus-frame-"+u.random).remove()}catch(t){}y=null,o=null,S=null,a=null,C=null,r=null,b.attr("data-focus-active","false").removeClass("ts-element-focus-active"),u.onHide.call(this),jQuery(document).unbind("keydown",d),jQuery(document).unbind("mousedown",f),jQuery(document).unbind("mousewheel DOMMouseScroll wheel",m),jQuery(window).unbind("scroll",m)}0!=I&&!u.repeat||"false"!=b.attr("data-focus-active")?l():(u.pageLoad&&(n=!0),setTimeout(function(){1==u.pagescroll&&jQuery("html, body").scrollTop(b.offset().top-(jQuery(window).height()-b.outerHeight()-50)),0==u.wait&&(u.wait=speed),T=(new Date).getTime(),j=parseInt(b.attr("data-focus-last")),_=u.wait,Q=j+_,Q>T&&j>0||($TS_VCSC_Lightbox_LastScroll=jQuery(document).scrollTop(),jQuery(document).bind("keydown",d),jQuery(document).bind("mousedown",f),jQuery(document).bind("mousewheel DOMMouseScroll wheel",m),jQuery(window).bind("scroll",m),p(),i(),u.rasterUse&&""!=u.rasterType&&(S=e('<div id="ts-element-focus-noise-'+u.random+'"></div>'),a=S,S.addClass("ts-element-focus-noise"),v.append(S),S.css({"background-image":'url("'+u.rasterType+'")'})),y.css("opacity",u.opacity),u.rasterUse&&""!=u.rasterType&&S.css("opacity",u.opacity),C.css("opacity",1),I=b.attr("data-focus-shown")?parseInt(b.attr("data-focus-shown"))+1:1,b.attr("data-focus-active","true").attr("data-focus-shown",I).addClass("ts-element-focus-active"),u.onShow.call(this),u.popupShow?setTimeout(function(){TS_VCSC_SweetAlert({title:u.popupTitle,text:u.popupText,html:u.popupHTML,type:u.popupType,position:u.popupPosition,showOverlay:!1,allowOutsideClick:!0,showConfirmButton:u.popupButton,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,closeFocus:u.popupClose,focusLayer:u.popupLayer,closeDelay:speed,confirmButtonText:u.popupConfirm,confirmButtonColor:"#AEDEF4",imageUrl:u.popupImage,imageSize:"100x100",fontIcon:u.popupIcon,fontIconSize:"100x100",fontIconColor:u.popupColor,timer:u.popupTimer,customClass:"ts-element-focus-popup",animation:!0,allowEscapeKey:!0},function(e){u.timer>0&&e&&setTimeout(function(){l()},u.timer+speed)})},speed):u.timer>0&&setTimeout(function(){l()},u.timer+speed))},u.delay),setTimeout(function(){i()},1e3))}}function l(){o&&0!=jQuery(".ts-element-focus-overlay").length&&!jQuery(".ts-element-focus-popup").hasClass("visible")&&t==u.random&&(o.css({opacity:0}),r.css({opacity:0}),u.rasterUse&&""!=u.rasterType&&a.css({opacity:0}),b.attr("data-focus-active","false").removeClass("ts-element-focus-active"),setTimeout(function(){try{o.remove()}catch(t){}try{a.remove()}catch(t){}try{r.remove()}catch(t){}y=null,o=null,w=null,S=null,a=null,C=null,r=null,v=null,b.attr("data-focus-last",(new Date).getTime()),u.pageLoad&&(n=!1),u.repeat||1!=parseInt(b.attr("data-focus-shown"))||b.off(),u.onHide.call(this),$TS_VCSC_Lightbox_LastScroll=jQuery(document).scrollTop(),jQuery(document).unbind("keydown",d),jQuery(document).unbind("mousedown",f),jQuery(document).unbind("mousewheel DOMMouseScroll wheel",m),jQuery(window).unbind("scroll",m),u.popupShow&&e(".ts-element-focus-popup").hasClass("visible")&&window.TS_VCSC_SweetAlert.closeModal()},speed))}function i(){"undefined"!=typeof o&&null!==o&&"null"!==o&&(o.attr("width",v.outerWidth()),o.attr("height",v.outerHeight()),w.fillStyle=u.focusColor,w.fillRect(0,0,v.innerWidth(),v.innerHeight()));var t=b.offset(),a=e(document).scrollTop(),n=t.left-u.paddingX,p=t.top-u.paddingY-a,s=b.outerWidth()+2*u.paddingX,l=b.outerHeight()+2*u.paddingY,i=u.frameStrength;"undefined"!=typeof o&&null!==o&&"null"!==o&&w.clearRect(n,p,s,l),"undefined"!=typeof r&&null!==r&&"null"!==r&&(r.css({top:p-i+"px",left:n-i+"px",width:s+2*i+"px",height:l+2*i+"px"}),r.attr("width",s+2*i),r.attr("height",l+2*i),g.fillStyle=u.frameColor,g.fillRect(0,0,s+2*i,l+2*i),g.clearRect(i,i,s,l))}function c(){"undefined"!=typeof w&&i()}function d(e){var t={37:1,38:1,39:1,40:1};return h(e.target)&&t[e.keyCode]?(e.preventDefault(),jQuery("html, body").scrollTop($TS_VCSC_Lightbox_LastScroll),!1):void 0}function f(e){return h(e.target)&&2==e.which?(e.preventDefault(),!1):void 0}function m(e){return h(e.target)?(e.preventDefault(),jQuery("html, body").scrollTop($TS_VCSC_Lightbox_LastScroll),!1):void 0}function h(e){var t=jQuery(e).closest(".sweet-container"),o=jQuery(e).closest(".sweet-alert");return t.length>0&&0==o.length?!0:o.length>0&&o.hasVerticalScrollBar()?!1:!0}var y,w,v,C,g,S,T,j,_,Q,b=e(this),x={extrafast:250,fast:500,medium:750,slow:1250,extraslow:2e3};jQuery.each(x,function(e,t){return e==u.speed?void(speed=t):void 0});var I=parseInt(b.attr("data-focus-shown"));if(this.createCanvas=function(){p()},this.showOverlay=function(){s()},this.closeOverlay=function(){l()},this.fillOverlay=function(){i()},this.handleResize=function(){c()},b.on(u.showEvent,s),jQuery(document).on("click",y,l),jQuery(document).keyup(function(e){var t=e.keyCode?e.keyCode:e.which;27==t&&"undefined"!=typeof o&&null!==o&&"null"!==o&&(l(),e.stopPropagation())}),u.pageLoad&&!u.viewportShow&&s(),!u.pageLoad&&u.viewportShow&&"undefined"!=typeof jQuery.fn.waypoint)var L=b.waypoint({handler:function(){if(s(),u.viewportOnce)try{L.destroy()}catch(e){}},offset:u.viewportOffset,triggerOnce:u.viewportOnce});jQuery(window).on("debouncedresize",function(){"true"==b.attr("data-focus-active")&&c()})})}}),function(){jQuery(window).load(function(){jQuery(".ts-element-focus-container").each(function(){var e=jQuery(this),t=parseInt(e.attr("data-focus-random")),o="true"==e.attr("data-focus-repeat")?!0:!1,a="true"==e.attr("data-focus-pageload")?!0:!1,r="true"==e.attr("data-focus-viewportshow")?!0:!1,n="true"==e.attr("data-focus-viewportonce")?!0:!1,p=e.attr("data-focus-viewportoffset"),a="true"==e.attr("data-focus-pageload")?!0:!1,u="true"==e.attr("data-focus-pagescroll")?!0:!1,s="true"==e.attr("data-focus-mobile")?!0:!1,l=e.attr("data-focus-speed"),i=e.attr("data-focus-focuscolor");""!=i&&void 0!=i&&(i=TS_VCSC_Color2Color(i,"hex",!1));var c=e.attr("data-focus-framecolor");""==c&&(c="#cccccc"),""!=c&&void 0!=c&&(c=TS_VCSC_Color2Color(c,"hex",!1));var d=parseInt(e.attr("data-focus-framestrength")),f="true"==e.attr("data-focus-rasteruse")?!0:!1,m=e.attr("data-focus-rastertype"),h=parseInt(e.attr("data-focus-opacity")),y=parseInt(e.attr("data-focus-delay")),w=parseInt(e.attr("data-focus-timer")),v=parseInt(e.attr("data-focus-wait")),C=parseInt(e.attr("data-focus-paddingx")),g=parseInt(e.attr("data-focus-paddingy")),S="true"==e.attr("data-popup-show")?!0:!1,T=e.attr("data-popup-title"),j=e.attr("data-popup-html");""!=j&&void 0!=j&&(j=decodeURIComponent(TS_VCSC_Base64.decode(j)));var _="true"==e.attr("data-popup-close")?!0:!1,Q=e.attr("data-popup-type");""==Q&&(Q=null);var b=e.attr("data-popup-position"),x=e.attr("data-popup-image"),I=e.attr("data-popup-icon"),L=e.attr("data-popup-color"),O="true"==e.attr("data-popup-button")?!0:!1,V=e.attr("data-popup-confirm"),k=parseInt(e.attr("data-popup-timer"));(0==TS_VCSC_MobileDevice||1==TS_VCSC_MobileDevice&&1==s)&&e.TS_VCSC_Element_Focus({random:t,repeat:o,timer:w,wait:v,delay:y,opacity:h/100,speed:l,focusColor:i,frameColor:c,frameStrength:d,pageLoad:a,pagescroll:u,viewportShow:r,viewportOnce:n,viewportOffset:p,rasterUse:f,rasterType:m,paddingX:C,paddingY:g,popupShow:0==TS_VCSC_MobileDevice?S:!1,popupTitle:T,popupHTML:j,popupClose:_,popupLayer:t,popupType:Q,popupPosition:b,popupButton:O,popupConfirm:V,popupImage:x,popupIcon:I,popupColor:L,popupTimer:k})})})}(jQuery);