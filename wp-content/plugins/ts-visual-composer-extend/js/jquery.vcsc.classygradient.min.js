!function(t){t.TS_VCSC_ClassyGradient=function(i,e){var n,r,s,a,o,d,g,c,h,l,u={gradient:"0% #02CDE8, 100% #000000",orientation:"top",type:"linear",shape:"ellipse",border:!1,svg:!1,webkit:!1,width:300,height:18,point:8,target:null,onChange:function(){},onInit:function(){}},f=t(i),p=new Array;return this.settings={},this.__constructor=function(){return this.settings=t.extend({},u,e),this.update(),this.settings.onInit(),this},this.update=function(){this._setupPoints(),this._setup(),this._render()},this.getCSS=function(){var i="",e=!1,n=!1,r="top",s="ellipse",a="linear",o="0%",d="100%",g="50%",c="50%",h="50%",l="left bottom";if(r=this.settings.orientation,a=this.settings.type,s=this.settings.shape,e=this.settings.svg,n=this.settings.webkit,border=this.settings.border,"left"===r&&(o="100%",d="0%",l="right top"),e)if("linear"==a)var u='<svg xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gradient" x1="0%" y1="0%" x2="'+o+'" y2="'+d+'">';else var u='<svg xmlns="http://www.w3.org/2000/svg"><defs><radialGradient id="gradient" cx="50%" cy="50%" r="'+g+'" fx="'+c+'" fy="'+h+'">';if("linear"==a)var f="-webkit-gradient(linear, left top, "+l;else var f="-webkit-gradient(radial, center center, 0px, center center, 100%";var b="";return t.each(p,function(t,i){f+=", color-stop("+i[0]+", "+i[1]+")",b+=","+i[1]+" "+i[0],e&&(u+='<stop offset="'+i[0]+'" style="stop-color:'+i[1]+';" />')}),f+=")",b=b.substr(1),e&&(u+="linear"==a?'</linearGradient></defs><rect fill="url(#gradient)" height="100%" width="100%" /></svg>':'</radialGradient></defs><rect fill="url(#gradient)" height="100%" width="100%" /></svg>',u=this._base64(u),i+="background: url(data:image/svg+xml;base64,"+u+");\n"),i+=(border?"-webkit-border-image: ":"background: ")+f+";\n","linear"==a?(i+=(border?"-moz-border-image: ":"background: ")+"-moz-linear-gradient("+r+","+b+");\n",i+=(border?"-webkit-border-image: ":"background: ")+"-webkit-linear-gradient("+r+","+b+");\n",i+=(border?"-o-border-image: ":"background: ")+"-o-linear-gradient("+r+","+b+");\n",i+=(border?"-ms-border-image: ":"background: ")+"-ms-linear-gradient("+r+","+b+");\n",i+=(border?"border-image: ":"background: ")+"linear-gradient("+("left"==r?"to right":"top"==r?"to bottom":r)+","+b+");"):(i+=(border?"-moz-border-image: ":"background: ")+"-moz-radial-gradient("+s+","+b+");\n",i+=(border?"-webkit-border-image: ":"background: ")+"-webkit-radial-gradient("+s+","+b+");\n",i+=(border?"-o-border-image: ":"background: ")+"-o-radial-gradient("+s+","+b+");\n",i+=(border?"-ms-border-image: ":"background: ")+"-ms-radial-gradient("+s+","+b+");\n",i+=(border?"border-image: ":"background: ")+"radial-gradient("+s+","+b+");"),i},this.getArray=function(){return p},this.getString=function(){var i="";return t.each(p,function(t,e){i+=e[0]+" "+e[1]+","}),i=i.substr(0,i.length-1)},this.setOrientation=function(t,i,e){this.settings.orientation=t,this.settings.type=i,this.settings.shape=e,this._renderToTarget()},this._setupPoints=function(){p=new Array,p=t.isArray(this.settings.gradient)?this.settings.gradient:this._getGradientFromString(this.settings.gradient)},this._setup=function(){var i=this;f.empty(),n=t('<div class="ClassyGradient"></div>'),r=t('<canvas class="canvas" width="'+this.settings.width+'" height="'+this.settings.height+'"></canvas>'),n.append(r),h=r.get(0).getContext("2d"),s=t('<div class="points"></div>'),s.css("width",this.settings.width+Math.round(this.settings.point/2+1)+"px"),n.append(s),a=t('<div class="info"></div>'),a.append('<div class="arrow"></div>'),n.append(a),o=t('<div class="content"></div>'),a.append(o),f.hover(function(){f.addClass("hover")},function(){f.removeClass("hover")}),d=t('<div class="point-color"><div style="background-color: #00ff00"></div></div>'),g=t('<span class="point-position">%</span>'),c=t('<a href="#" class="delete"></a>'),o.append(d,g,c),f.append(n),d.ColorPicker({flat:!1,color:"#00ff00",onSubmit:function(t,e){f.find(".point-color div").css("backgroundColor","#"+e),l.css("backgroundColor","#"+e),i._renderCanvas(),i._renderToTarget()},onChange:function(t,e){f.find(".point-color div").css("backgroundColor","#"+e),l.css("backgroundColor","#"+e),i._renderCanvas(),i._renderToTarget()}}),t(document).bind("click",function(){f.is(".hover")||a.hide("fast")}),r.unbind("click"),r.bind("click",function(e){var n=r.offset(),a=e.pageX-n.left;a=Math.round(100*a/i.settings.width);var o="#000000",d=999999999999;t.each(p,function(t,i){parseInt(i[0])<a&&a-parseInt(i[0])<d?(d=a-parseInt(i[0]),o=i[1]):parseInt(i[0])>a&&parseInt(i[0])-a<d&&(d=parseInt(i[0])-a,o=i[1])}),p.push([a+"%",o]),p.sort(i._sortByPosition),i._render(),t.each(p,function(t,e){e[0]==a+"%"&&i._selectPoint(s.find(".point:eq("+t+")"))})})},this._render=function(){this._initGradientPoints(),this._renderCanvas(),this._renderToTarget()},this._initGradientPoints=function(){var i=this;s.empty(),t.each(p,function(t,e){s.append('<div class="point" style="background-color: '+e[1]+"; left:"+parseInt(e[0])*i.settings.width/100+'px;"></div>')}),s.find(".point").css("width",this.settings.point+"px").css("height",this.settings.point+"px").mouseup(function(){i._selectPoint(this)}).draggable({axis:"x",containment:"parent",drag:function(){i._selectPoint(this),i._renderCanvas(),i._renderToTarget()}})},this._selectPoint=function(i){var e=this;l=t(i);var n=t(i).css("backgroundColor"),r=parseInt(t(i).css("left"));r=Math.round(r/this.settings.width*100),n=n.substr(4,n.length),n=n.substr(0,n.length-1),d.ColorPickerSetColor(this._rgbToHex(n.split(","))),d.find("div").css("backgroundColor",this._rgbToHex(n.split(","))),g.html("Position: "+r+"%"),c.unbind("click").bind("click",function(){return p.length>1&&(p.splice(l.index(),1),e._render(),f.find(".info").hide("fast")),!1}),f.find(".info").css("marginLeft",parseInt(t(i).css("left"))-30+"px").show("fast")},this._renderCanvas=function(){var i=this;p=new Array,f.find(".point").each(function(e,n){var r=Math.round(parseInt(t(n).css("left"))/i.settings.width*100),s=t(n).css("backgroundColor").substr(4,t(n).css("backgroundColor").length-5);s=i._rgbToHex(s.split(",")),p.push([r+"%",s])}),p.sort(i._sortByPosition),this._renderToCanvas(),this.settings.onChange(this.getString(),this.getCSS(),this.getArray())},this._renderToElement=function(i,e){var n="0%",s="100%",a="50%",d="50%",g="50%",c="left bottom",h=!1,l="top",u="ellipse",f="linear";if(l=this.settings.orientation,f=this.settings.type,u=this.settings.shape,h=this.settings.svg,(i===r||"left"===l)&&(n="100%",s="0%",c="right top"),"linear"==f){if(h)var p='<svg xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gradient" x1="0%" y1="0%" x2="'+n+'" y2="'+s+'">';var b="-webkit-gradient(linear, left top, "+c}else{if(h)var p='<svg xmlns="http://www.w3.org/2000/svg"><defs><radialGradient id="gradient" cx="50%" cy="50%" r="'+a+'" fx="'+d+'" fy="'+g+'">';var b="-webkit-gradient(radial, center center, 0px, center center, 100%"}var v="";if(t.each(e,function(t,i){b+=", color-stop("+i[0]+", "+i[1]+")",v+=","+i[1]+" "+i[0],h&&(p+='<stop offset="'+i[0]+'" style="stop-color:'+i[1]+';" />')}),b+=")",v=v.substr(1),h&&(p+="linear"==f?"</linearGradient></defs>":"</radialGradient></defs>"),i===o){var k=parseInt(o.css("borderRadius"));h&&(p+='<rect fill="url(#gradient)" height="100%" width="100%" rx="'+k+'" ry="'+k+'" />')}else h&&(p+='<rect fill="url(#gradient)" height="100%" width="100%" />');h&&(p+="</svg>",p=this._base64(p),i.css("background","url(data:image/svg+xml;base64,"+p+")")),i.css("background",b),"linear"==f?(i.css("background","-moz-linear-gradient("+l+","+v+")"),i.css("background","-webkit-linear-gradient("+l+","+v+")"),i.css("background","-o-linear-gradient("+l+","+v+")"),i.css("background","-ms-linear-gradient("+l+","+v+")"),i.css("background","linear-gradient("+("left"==l?"to right":"top"==l?"to bottom":l)+","+v+")")):(i.css("background","-moz-radial-gradient("+u+","+v+")"),i.css("background","-webkit-radial-gradient("+u+","+v+")"),i.css("background","-o-radial-gradient("+u+","+v+")"),i.css("background","-ms-radial-gradient("+u+","+v+")"),i.css("background","radial-gradient("+u+","+v+")"))},this._renderToTarget=function(){null!==this.settings.target&&this._renderToElement(t(this.settings.target),p)},this._renderToCanvas=function(){var i=h.createLinearGradient(0,0,this.settings.width,0);t.each(p,function(t,e){i.addColorStop(parseInt(e[0])/100,e[1])}),h.clearRect(0,0,this.settings.width,this.settings.height),h.fillStyle=i,h.fillRect(0,0,this.settings.width,this.settings.height),this.settings.onChange(this.getString(),this.getCSS(),this.getArray())},this._getGradientFromString=function(i){var e=new Array,n=i.split(",");return t.each(n,function(t,i){var n;"100"==i.substr(i.indexOf("%")-3,i.indexOf("%"))||"100%"==i.substr(i.indexOf("%")-3,i.indexOf("%"))?n="100%":i.indexOf("%")>1?(n=parseInt(i.substr(i.indexOf("%")-2,i.indexOf("%"))),n+="%"):(n=parseInt(i.substr(i.indexOf("%")-1,i.indexOf("%"))),n+="%");var r=i.substr(i.indexOf("#"),7);e.push([n,r])}),e},this._rgbToHex=function(t){function i(t){return t=parseInt(t,10),isNaN(t)?"00":(t=Math.max(0,Math.min(t,255)),"0123456789ABCDEF".charAt((t-t%16)/16)+"0123456789ABCDEF".charAt(t%16))}var e=t[0],n=t[1],r=t[2];return"#"+i(e)+i(n)+i(r)},this._sortByPosition=function(t,i){return parseInt(t[0])<parseInt(i[0])?-1:parseInt(t[0])>parseInt(i[0])?1:0},this._base64=function(t){for(var i,e,n,r,s,a,o,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g="",c=0;c<t.length;)i=t.charCodeAt(c++),e=t.charCodeAt(c++),n=t.charCodeAt(c++),r=i>>2,s=(3&i)<<4|e>>4,a=(15&e)<<2|n>>6,o=63&n,isNaN(e)?a=o=64:isNaN(n)&&(o=64),g+=d.charAt(r)+d.charAt(s)+d.charAt(a)+d.charAt(o);return g},this.__constructor()},t.fn.TS_VCSC_ClassyGradient=function(i){return this.each(function(){if(void 0===t(this).data("ClassyGradient")){var e=new t.TS_VCSC_ClassyGradient(this,i);t(this).data("ClassyGradient",e)}})}}(jQuery);